
<link rel="stylesheet" href="https://unpkg.com/dropzone/dist/dropzone.css" />
    <link href="https://unpkg.com/cropperjs/dist/cropper.css" rel="stylesheet"/>
    
    <script src="https://unpkg.com/dropzone"></script>
    <script src="https://unpkg.com/cropperjs"></script>
<style>
    .preview {
        overflow: hidden;
        width: 160px;
        height: 160px;
        margin: 10px;
        border: 1px solid red;
    }

    .modal-lg {
        max-width: 1000px !important;
    }
</style>
<form action="/admin/admin-addproduct" onsubmit="return Validate(this);" method="post" enctype="multipart/form-data" style="margin-left:400px;margin-top:150px">
          <div class="mb-4">
            <label for="product_name" class="form-label">Product title</label>
            <input type="text" placeholder="Type here" class="form-control" name="title" id="product_name">
          </div>

          <div class="mb-4">
            <label class="form-label">product description</label>
            <textarea placeholder="Type here" name="description" class="form-control" rows="4"></textarea>
          </div>
    <div>
          <div class="fileinput fileinput-new text-center mb-4">
							<div class="fileinput-new thumbnail">
								<img src="../../assets/img/image_placeholder.jpg" id="chekPreview1" alt="..."  width="50px">

							</div>
							<div>
								{{!-- <span class="btn btn-rose btn-round btn-file"> --}}
									{{!-- <span class="fileinput-new">Select image</span> --}}
									<input type="file" id="image1" class="form-control" name="image1"  required />
									<textarea name="image2_b64" id="imageValue1" cols="30" rows="10" hidden></textarea>
								{{!-- </span> --}}
							</div>
						</div>

     </div>
       <div>
          <div class="fileinput fileinput-new text-center mb-4">
							<div class="fileinput-new thumbnail">
								<img src="../../assets/img/image_placeholder.jpg" id="chekPreview2" alt="..."  width="50px">

							</div>
							<div>
								{{!-- <span class="btn btn-rose btn-round btn-file"> --}}
									{{!-- <span class="fileinput-new">Select image</span> --}}
									<input type="file" id="image2" class="form-control" name="image2"  required />
									<textarea name="image3_b64" id="imageValue2" cols="30" rows="10" hidden></textarea>
								{{!-- </span> --}}
							</div>
						</div>

     </div>
      <div>
          <div class="fileinput fileinput-new text-center mb-4">
							<div class="fileinput-new thumbnail">
								<img src="../../assets/img/image_placeholder.jpg" id="chekPreview3" alt="..."  width="50px">

							</div>
							<div>
								{{!-- <span class="btn btn-rose btn-round btn-file"> --}}
									{{!-- <span class="fileinput-new">Select image</span> --}}
									<input type="file" id="image3" class="form-control"  name="image3" required />
									<textarea name="image1_b64" id="imageValue3" cols="30" rows="10" hidden></textarea>
								{{!-- </span> --}}
							</div>
						</div>

     </div>








         





          <div class="row gx-2">
            <div class="col-sm-6 mb-3">
              <label class="form-label">Category</label>
                 <select class="form-select" name="category" id="category" onchange="getCat()" >
                <option> Select </option>
                {{#each categoryDetails}}
                <option value="{{this.category}}">{{this.category}}</option>
                {{/each}}
              </select>
            </div>
            <div class="col-sm-6 mb-3">
              <label class="form-label">Sub-category</label>
              <select class="form-select" name="subcategory" id="subcategory">
                <option> Select </option>

              </select>
            </div>
          </div> <!-- row.// -->


          <div class="mb-4">
            <label class="form-label">Price(â‚¹)</label>
            <div class="row gx-2">
              <div class="col-4">
                <input placeholder="price" name="price" type="number" class="form-control">

              </div>

            </div> <!-- row.// -->
          </div>

          <div class="mb-4">
            <label class="form-label">Quantity</label>
            <div class="row gx-2">
              <div class="col-4">
                <input placeholder="quantity" name="quantity" type="number" class="form-control">
              </div>

            </div> <!-- row.// -->
          </div>



          <button class="btn btn-primary" type="submit">Add product</button>

        </form>

        <div class="modal fade" id="modal1" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Crop Image Here</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="img-container">
                    <div class="row">
                        <div class="col-md-8">
                            <img src="" id="sampleImage1" />
                        </div>
                        <div class="col-md-4">
                            <div class="preview" id="preview1"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">

                <button type="button" id="crop1" class="btn btn-primary">Crop</button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>

            </div>
        </div>
    </div>
</div>
<!-- Modal  1 end-->



<!-- Modal 2-->
<div class="modal fade" id="modal2" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Crop Image Here</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="img-container">
                    <div class="row">
                        <div class="col-md-8">
                            <img src="" id="sampleImage2" />
                        </div>
                        <div class="col-md-4">
                            <div class="preview" id="preview2"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">

                <button type="button" id="crop2" class="btn btn-primary">Crop</button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>

            </div>
        </div>
    </div>
</div>
<!-- Modal  2 end-->


<!-- Modal 3-->
<div class="modal fade" id="modal3" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Crop Image Here</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="img-container">
                    <div class="row">
                        <div class="col-md-8">
                            <img src="" id="sampleImage3" />
                        </div>
                        <div class="col-md-4">
                            <div class="preview" id="preview3"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">

                <button type="button" id="crop3" class="btn btn-primary">Crop</button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>

            </div>
        </div>
    </div>
</div>
<!-- Modal  3 end-->

<!-- Modal 4-->
<div class="modal fade" id="modal4" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Crop Image Here</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="img-container">
                    <div class="row">
                        <div class="col-md-8">
                            <img src="" id="sampleImage4" />
                        </div>
                        <div class="col-md-4">
                            <div class="preview" id="preview4"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">

                <button type="button" id="crop4" class="btn btn-primary">Crop</button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>

            </div>
        </div>
    </div>
</div>
<!-- Modal  4 end-->


<script>
    $('document').ready(function() {
//modal1 and image 1
    var image1 = document.getElementById('sampleImage1');
    var modal1 = $('#modal1');
    var cropper1;

    $('#image1').change(function (event) {
        var files = event.target.files;

        var done = function (url) {
            image1.src = url;
            modal1.modal('show');
        };

        if (files && files.length > 0) {
            reader = new FileReader();
            reader.onload = function (event) {
                done(reader.result);
            };
            reader.readAsDataURL(files[0]);
        }
    });

    modal1.on('shown.bs.modal', function () {
        cropper1 = new Cropper(image1, {
            aspectRatio: 1,
            viewMode: 3,
            preview: '#preview1'
        });
    }).on('hidden.bs.modal', function () {
        cropper1.destroy();
        cropper1 = null;
    });

    $('#crop1').click(function () {
        canvas = cropper1.getCroppedCanvas({
            width: 400,
            height: 400
        });

        canvas.toBlob(function (blob) {
            url = URL.createObjectURL(blob);
            var reader = new FileReader();
            reader.readAsDataURL(blob);
            reader.onloadend = function () {
                var base64data = reader.result;
                modal1.modal('hide');
                $("#imageValue1").val(base64data)
                $('#chekPreview1').attr('src', base64data);
            };
        });
    });
//modal1 and image 1 end

//modal2 and image 2
    var image2 = document.getElementById('sampleImage2');
    var modal2 = $('#modal2');
    var cropper2;

    $('#image2').change(function (event) {
        var files = event.target.files;

        var done = function (url) {
            image2.src = url;
            modal2.modal('show');
        };

        if (files && files.length > 0) {
            reader = new FileReader();
            reader.onload = function (event) {
                done(reader.result);
            };
            reader.readAsDataURL(files[0]);
        }
    });

    modal2.on('shown.bs.modal', function () {
        cropper2 = new Cropper(image2, {
            aspectRatio: 1,
            viewMode: 3,
            preview: '#preview2'
        });
    }).on('hidden.bs.modal', function () {
        cropper2.destroy();
        cropper2 = null;
    });

    $('#crop2').click(function () {
        canvas = cropper2.getCroppedCanvas({
            width: 400,
            height: 400
        });

        canvas.toBlob(function (blob) {
            url = URL.createObjectURL(blob);
            var reader = new FileReader();
            reader.readAsDataURL(blob);
            reader.onloadend = function () {
                var base64data = reader.result;
                modal2.modal('hide');
                $("#imageValue2").val(base64data)
                $('#chekPreview2').attr('src', base64data);
            };
        });
    });
//image 2 and modal 2 end


//modal3 and image 3 start
    var image3 = document.getElementById('sampleImage3');
    var modal3 = $('#modal3');
    var cropper3;

    $('#image3').change(function (event) {
        var files = event.target.files;

        var done = function (url) {
            image3.src = url;
            modal3.modal('show');
        };

        if (files && files.length > 0) {
            reader = new FileReader();
            reader.onload = function (event) {
                done(reader.result);
            };
            reader.readAsDataURL(files[0]);
        }
    });

    modal3.on('shown.bs.modal', function () {
        cropper3 = new Cropper(image3, {
            aspectRatio: 1,
            viewMode: 3,
            preview: '#preview3'
        });
    }).on('hidden.bs.modal', function () {
        cropper3.destroy();
        cropper3 = null;
    });

    $('#crop3').click(function () {
        canvas = cropper3.getCroppedCanvas({
            width: 400,
            height: 400
        });

        canvas.toBlob(function (blob) {
            url = URL.createObjectURL(blob);
            var reader = new FileReader();
            reader.readAsDataURL(blob);
            reader.onloadend = function () {
                var base64data = reader.result;
                modal3.modal('hide');
                $("#imageValue3").val(base64data)
                $('#chekPreview3').attr('src', base64data);
            };
        });
    });
//image 3 and modal 3 end

//modal4 and image 4 start
    var image4 = document.getElementById('sampleImage4');
    var modal4 = $('#modal4');
    var cropper4;

    $('#image4').change(function (event) {
        var files = event.target.files;

        var done = function (url) {
            image4.src = url;
            modal4.modal('show');
        };

        if (files && files.length > 0) {
            reader = new FileReader();
            reader.onload = function (event) {
                done(reader.result);
            };
            reader.readAsDataURL(files[0]);
        }
    });

    modal4.on('shown.bs.modal', function () {
        cropper4 = new Cropper(image4, {
            aspectRatio: 1,
            viewMode: 3,
            preview: '#preview4'
        });
    }).on('hidden.bs.modal', function () {
        cropper4.destroy();
        cropper4 = null;
    });

    $('#crop4').click(function () {
        canvas = cropper4.getCroppedCanvas({
            width: 400,
            height: 400
        });

        canvas.toBlob(function (blob) {
            url = URL.createObjectURL(blob);
            var reader = new FileReader();
            reader.readAsDataURL(blob);
            reader.onloadend = function () {
                var base64data = reader.result;
                modal4.modal('hide');
                $("#imageValue4").val(base64data)
                $('#chekPreview4').attr('src', base64data);
            };
        });
    });
//image 4 and modal 4 end
});

</script>
<script>

function getCat(){
  alert('category')
let category= $('#category').val()
  $.ajax({
    url:'/admin/get-sub-category',
    data:{category},
    method:'post',
    success:(data)=>{
                alert(data)
      $('#subcategory').find('option').remove()
      
      for(i=0;i<data.length;i++){
        
        $('#subcategory').append('<option>'+data[i].name+'</option>')
      }
    }
  })
}
</script>
